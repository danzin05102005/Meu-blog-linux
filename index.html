<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Linux Lab - Tech & Games</title>
    <meta name="theme-color" content="#050505">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- ESTILO GERAL CYBERPUNK --- */
        :root { 
            --bg: #050505; 
            --neon-green: #00ff41; 
            --neon-blue: #00f3ff; 
            --card-bg: #111; 
            --font: 'Fira Code', monospace; 
        }
        body { background-color: var(--bg); font-family: var(--font); color: #ddd; padding-top: 80px; }

        /* HEADER FIXO */
        .cyber-nav {
            position: fixed; top: 0; left: 0; width: 100%; background: rgba(0,0,0,0.95);
            border-bottom: 2px solid var(--neon-green); padding: 15px 20px; z-index: 999;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.2);
        }
        .cyber-nav a { color: #fff; text-decoration: none; margin-left: 20px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .cyber-nav a:hover { color: var(--neon-green); text-shadow: 0 0 10px var(--neon-green); }

        /* CARDS (LISTA DE POSTS) */
        .card-post {
            background-color: var(--card-bg); border: 1px solid #333; border-left: 4px solid var(--neon-green);
            border-radius: 6px; margin-bottom: 25px; padding: 20px; transition: 0.2s;
        }
        .card-post:hover { border-color: var(--neon-green); transform: translateX(5px); }

        /* BOT√ÉO DE CURTIR */
        .btn-like {
            background: #1a1a1a; border: 1px solid #444; color: #888; 
            padding: 8px 20px; border-radius: 30px; cursor: pointer; display: inline-flex; align-items: center; gap: 8px;
            font-weight: bold; transition: 0.3s;
        }
        .btn-like.curtido {
            border-color: #ff0041; color: #ff0041; background: rgba(255,0,65,0.1); box-shadow: 0 0 10px rgba(255,0,65,0.2);
        }
        .btn-like:hover { transform: scale(1.05); }

        /* TELAS E ANIMA√á√ÉO */
        .tela { display: none; padding-bottom: 50px; }
        .fade-in { animation: entrar 0.4s ease-out; }
        @keyframes entrar { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* ESTILO DO SOBRE */
        .caixa-sugestao { border: 1px dashed var(--neon-blue); padding: 25px; border-radius: 8px; margin-top: 30px; background: #0a0a0a; }
        textarea { background: #000 !important; border-color: #333 !important; color: #fff !important; }
        
        /* ESTILO DO REL√ìGIO */
        #relogio-bloqueio {
            display: none;
            color: #ffdd57;
            font-weight: bold;
            margin-top: 10px;
            text-align: center;
            border: 1px solid #ffdd57;
            padding: 10px;
            border-radius: 5px;
            background: rgba(255, 221, 87, 0.1);
        }

        /* ESTILO DO ARTIGO ABERTO */
        .artigo-container img { max-width: 100%; border-radius: 5px; border: 1px solid #333; }
        .artigo-container h2, .artigo-container h3 { color: var(--neon-green); margin-top: 25px; }
        .artigo-container pre { border: 1px solid var(--neon-blue); background: #080808; }
    </style>
</head>
<body>

    <nav class="cyber-nav">
        <span style="color: var(--neon-green); font-weight:bold; letter-spacing: 1px;">LINUX LAB_</span>
        <div>
            <a onclick="navegar('home')">HOME</a>
            <a onclick="navegar('sobre')">SOBRE</a>
        </div>
    </nav>

    <div id="tela-home" class="tela fade-in container">
        <header style="text-align: center; margin-bottom: 40px;">
            <h1 style="color: #fff; margin:0">> SYSTEM LOGS</h1>
            <p style="color: #666;">Hardware ‚Ä¢ Otimiza√ß√£o ‚Ä¢ Games</p>
        </header>
        
        <div id="lista-posts">
            <div style="text-align: center; margin-top: 50px;">
                <p style="color: var(--neon-green)">CONECTANDO AO BANCO DE DADOS...</p>
                <progress></progress>
            </div>
        </div>

        <footer style="text-align: center; opacity: 0.5; font-size: 0.8em; margin-top: 50px;">
            DEV: DANILO ‚Ä¢ STATUS: ONLINE
        </footer>
    </div>

    <div id="tela-sobre" class="tela fade-in container">
        <h2 style="color: var(--neon-blue)">SOBRE O PROJETO</h2>
        <p>Bem-vindo ao <strong>Linux Lab</strong>. Este blog √© mantido por Danilo, com foco em provar que hardware antigo ainda tem valor se usado com o software correto (Linux Mint).</p>
        
        <div class="caixa-sugestao">
            <h4 style="color: var(--neon-blue)">üí° CENTRAL DE IDEIAS</h4>
            <p style="color: #ccc; font-size: 0.9em;">Tem uma dica ou quer pedir um artigo? Envie aqui.<br><small>(Anti-Flood: 1 ideia a cada 72h)</small></p>
            
            <textarea id="texto-sugestao" rows="4" placeholder="Ex: Faz um tutorial sobre ZRam..."></textarea>
            
            <button onclick="enviarSugestao()" class="contrast" id="btn-sugestao" style="width: 100%;">ENVIAR IDEIA üöÄ</button>
            
            <div id="relogio-bloqueio">
                ‚è≥ Aguarde <span id="tempo-restante">00h 00m 00s</span> para enviar novamente.
            </div>

            <p id="msg-sugestao" style="margin-top:15px; font-weight:bold; text-align: center;"></p>
        </div>
    </div>

    <div id="tela-leitura" class="tela fade-in container">
        <nav><a onclick="navegar('home')" style="color: var(--neon-green); cursor:pointer; text-decoration: underline;">[ ‚Üê Voltar para Lista ]</a></nav>
        
        <article id="conteudo-artigo" class="artigo-container" style="border: 1px solid #333; padding: 25px; border-radius: 8px; background: #111; margin-top:20px;">
            </article>

        <div style="margin-top: 30px; text-align: center; border-top: 1px solid #333; padding-top: 30px;">
            <p style="margin-bottom: 15px;">Este artigo foi √∫til?</p>
            <button id="btn-curtir" class="btn-like" onclick="curtirAtual()">
                ü§ç Carregando...
            </button>
            <p style="font-size: 0.8em; color: #555; margin-top: 10px;">(Limite: 1 like por pessoa)</p>
        </div>
        
        <footer style="margin-top: 50px; text-align: center;">
            <button class="outline" onclick="navegar('home')">VOLTAR AO IN√çCIO</button>
        </footer>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <script>
        // --- 1. CONFIGURA√á√ÉO (SUAS CHAVES) ---
        const firebaseConfig = {
            apiKey: "AIzaSyDnkmZ7BMasKQQGnAQSTi3jxiuCbxyLU7M",
            authDomain: "meubloglinux.firebaseapp.com",
            projectId: "meubloglinux",
            storageBucket: "meubloglinux.firebasestorage.app",
            messagingSenderId: "262696388382",
            appId: "1:262696388382:web:d2784dc5dbba922cc8eb0f"
        };
        
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const db = firebase.firestore();

        let TODOS_POSTS = {}; 
        let ID_POST_ATUAL = null;
        let INTERVALO_RELOGIO = null; // Para controlar o timer

        // --- 2. CARREGAR POSTS (TEMPO REAL) ---
        db.collection("posts").orderBy("data", "desc").onSnapshot((snapshot) => {
            const listaDiv = document.getElementById('lista-posts');
            
            if(snapshot.empty) { 
                listaDiv.innerHTML = "<p style='text-align:center; padding: 50px;'>Nenhum artigo publicado ainda.</p>"; 
                TODOS_POSTS = {};
                return; 
            }

            listaDiv.innerHTML = "";
            TODOS_POSTS = {};

            snapshot.forEach((doc) => {
                const post = doc.data();
                TODOS_POSTS[doc.id] = post;
                const likes = post.likes ? post.likes : 0;

                listaDiv.innerHTML += `
                    <div class="card-post" onclick="abrirArtigo('${doc.id}')" style="cursor: pointer;">
                        <div style="display:flex; justify-content:space-between; margin-bottom: 10px;">
                            <small style="color:#666">${new Date(post.data).toLocaleDateString('pt-BR')}</small>
                            <small style="color: var(--neon-green)">‚ù§Ô∏è ${likes}</small>
                        </div>
                        <h3 style="margin: 0; color: #fff;">${post.titulo}</h3>
                        <p style="color: #888; font-size: 0.9em; margin-top: 10px;">Toque para ler a an√°lise completa...</p>
                        <button style="margin-top:10px; font-size: 0.8em; padding: 5px 15px;">ACESSAR</button>
                    </div>
                `;
            });
            checarRota();
        });

        // --- 3. NAVEGA√á√ÉO E ROTAS ---
        function navegar(destino) {
            document.querySelectorAll('.tela').forEach(t => t.style.display = 'none');
            
            if (destino === 'home') {
                document.getElementById('tela-home').style.display = 'block';
                location.hash = '';
                window.scrollTo(0,0);
            } else if (destino === 'sobre') {
                document.getElementById('tela-sobre').style.display = 'block';
                location.hash = 'sobre';
                window.scrollTo(0,0);
                iniciarRelogioBloqueio(); // Inicia a verifica√ß√£o do rel√≥gio ao entrar na tela
            }
        }

        function abrirArtigo(id) {
            location.hash = id;
        }

        function checarRota() {
            const hash = location.hash.replace('#', '');
            
            if (hash === 'sobre') {
                navegar('sobre');
            } else if (hash && TODOS_POSTS[hash]) {
                ID_POST_ATUAL = hash;
                const post = TODOS_POSTS[hash];
                const likes = post.likes ? post.likes : 0;

                document.getElementById('conteudo-artigo').innerHTML = `
                    <h1 style="color: var(--neon-green); border-bottom: 1px solid #333; padding-bottom: 15px;">${post.titulo}</h1>
                    ${post.conteudo}
                `;
                
                configurarBotaoLike(likes);

                document.querySelectorAll('.tela').forEach(t => t.style.display = 'none');
                document.getElementById('tela-leitura').style.display = 'block';
                window.scrollTo(0,0);
            } else {
                if(location.hash !== '#sobre') navegar('home');
            }
        }
        window.addEventListener('hashchange', checarRota);

        // --- 4. SISTEMA DE LIKES ---
        function configurarBotaoLike(likes) {
            const btnLike = document.getElementById('btn-curtir');
            if (localStorage.getItem('like_' + ID_POST_ATUAL)) {
                btnLike.classList.add('curtido');
                btnLike.innerHTML = `‚ù§Ô∏è ${likes} (Voc√™ curtiu)`;
                btnLike.style.cursor = "default";
            } else {
                btnLike.classList.remove('curtido');
                btnLike.innerHTML = `ü§ç Curtir (${likes})`;
                btnLike.style.cursor = "pointer";
                btnLike.disabled = false;
            }
        }

        function curtirAtual() {
            if (!ID_POST_ATUAL) return;

            if (localStorage.getItem('like_' + ID_POST_ATUAL)) {
                alert("Voc√™ j√° curtiu este artigo! Obrigado.");
                return;
            }

            const btn = document.getElementById('btn-curtir');
            btn.innerHTML = "Processando...";
            
            const incremento = firebase.firestore.FieldValue.increment(1);

            db.collection("posts").doc(ID_POST_ATUAL).set({ likes: incremento }, { merge: true })
            .then(() => {
                localStorage.setItem('like_' + ID_POST_ATUAL, 'true');
                btn.classList.add('curtido');
            })
            .catch((error) => {
                console.error("Erro:", error);
                alert("Erro ao curtir. Tente novamente.");
            });
        }

        // --- 5. SISTEMA DE SUGEST√ïES COM REL√ìGIO ---
        
        function iniciarRelogioBloqueio() {
            const ultimaVez = localStorage.getItem('ultima_sugestao');
            const btn = document.getElementById('btn-sugestao');
            const caixaRelogio = document.getElementById('relogio-bloqueio');
            const textoRelogio = document.getElementById('tempo-restante');
            
            // Se n√£o tem timer, garante que est√° tudo limpo
            if (INTERVALO_RELOGIO) clearInterval(INTERVALO_RELOGIO);

            if (!ultimaVez) return; // Nunca enviou, deixa liberado

            INTERVALO_RELOGIO = setInterval(() => {
                const agora = Date.now();
                const limite = 259200000; // 72 horas em milissegundos
                const tempoPassado = agora - ultimaVez;
                
                if (tempoPassado < limite) {
                    // EST√Å BLOQUEADO: Calcula o tempo que falta
                    const tempoRestante = limite - tempoPassado;
                    
                    const horas = Math.floor((tempoRestante / (1000 * 60 * 60)));
                    const minutos = Math.floor((tempoRestante % (1000 * 60 * 60)) / (1000 * 60));
                    const segundos = Math.floor((tempoRestante % (1000 * 60)) / 1000);

                    // Atualiza a tela
                    btn.disabled = true;
                    btn.innerText = "BLOQUEADO TEMPORARIAMENTE";
                    btn.style.opacity = "0.5";
                    btn.style.cursor = "not-allowed";
                    
                    caixaRelogio.style.display = "block";
                    textoRelogio.innerText = `${horas}h ${minutos}m ${segundos}s`;
                } else {
                    // J√Å LIBEROU
                    btn.disabled = false;
                    btn.innerText = "ENVIAR IDEIA üöÄ";
                    btn.style.opacity = "1";
                    btn.style.cursor = "pointer";
                    caixaRelogio.style.display = "none";
                    clearInterval(INTERVALO_RELOGIO);
                }
            }, 1000); // Roda a cada 1 segundo
        }

        function enviarSugestao() {
            const texto = document.getElementById('texto-sugestao').value;
            const msg = document.getElementById('msg-sugestao');
            const btn = document.getElementById('btn-sugestao');

            if (!texto) { alert("A caixa est√° vazia!"); return; }

            // Verifica√ß√£o R√°pida antes de enviar
            const ultimaVez = localStorage.getItem('ultima_sugestao');
            const agora = Date.now();
            const limite = 259200000;

            if (ultimaVez && (agora - ultimaVez) < limite) {
                alert("Aguarde o tempo acabar!");
                return;
            }

            btn.setAttribute('aria-busy', 'true');
            btn.innerText = "ENVIANDO...";
            
            db.collection("sugestoes").add({
                texto: texto,
                data: agora,
                status: "nova"
            }).then(() => {
                localStorage.setItem('ultima_sugestao', agora);
                document.getElementById('texto-sugestao').value = "";
                msg.innerText = "‚úÖ Ideia enviada! O rel√≥gio come√ßou a contar.";
                msg.style.color = "#00ff41";
                btn.setAttribute('aria-busy', 'false');
                iniciarRelogioBloqueio(); // Inicia o timer imediatamente
            })
            .catch(err => {
                msg.innerText = "Erro ao enviar: " + err.message;
                msg.style.color = "red";
                btn.setAttribute('aria-busy', 'false');
            });
        }
    </script>
</body>
</html>