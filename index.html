<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linux Lab | Cyberpunk Blog</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        /* --- ESTILO CYBERPUNK --- */
        :root { --bg: #050505; --panel: #111; --text: #eee; --neon-green: #00ff41; --neon-purple: #9d00ff; }
        body { background-color: var(--bg); color: var(--text); font-family: 'Courier New', monospace; margin: 0; padding-bottom: 80px; }
        
        /* Cabe√ßalho */
        header { text-align: center; padding: 20px; border-bottom: 2px solid var(--neon-green); background: radial-gradient(circle, #1a1a1a 0%, #000 100%); }
        h1 { margin: 0; color: var(--neon-green); text-transform: uppercase; letter-spacing: 2px; }
        #relogio { font-size: 2.5rem; font-weight: bold; text-shadow: 0 0 10px var(--neon-green); margin: 10px 0; }
        
        /* Busca */
        .search-box { margin: 20px auto; max-width: 90%; text-align: center; }
        #busca-input { width: 100%; max-width: 400px; padding: 10px; background: #000; border: 1px solid var(--neon-purple); color: var(--neon-green); outline: none; border-radius: 5px; }

        /* Grid de Posts */
        .container { padding: 20px; max-width: 800px; margin: 0 auto; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        
        .card { background: var(--panel); border: 1px solid #333; padding: 15px; border-radius: 8px; cursor: pointer; transition: 0.3s; position: relative; overflow: hidden; }
        .card:hover { border-color: var(--neon-green); transform: translateY(-5px); box-shadow: 0 0 15px rgba(0, 255, 65, 0.2); }
        .card h2 { color: #fff; font-size: 1.2rem; margin-bottom: 5px; }
        .card span { font-size: 0.8rem; color: var(--neon-purple); display: block; margin-bottom: 5px; }

        /* Tela de Leitura */
        #leitura-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); overflow-y: auto; z-index: 100; padding: 20px; box-sizing: border-box; }
        .btn-voltar { background: transparent; border: 1px solid var(--neon-green); color: var(--neon-green); padding: 10px 20px; font-weight: bold; cursor: pointer; margin-bottom: 20px; display: inline-block; }
        #conteudo-post h2 { color: var(--neon-green); border-bottom: 1px solid #333; padding-bottom: 10px; }
        #conteudo-post p { line-height: 1.6; color: #ccc; margin-bottom: 15px; }
        pre { background: #1a1a1a; padding: 10px; border-radius: 5px; overflow-x: auto; border: 1px solid #333; color: var(--neon-green); }

        /* Bot√£o Pix Flutuante */
        .btn-pix { position: fixed; bottom: 20px; right: 20px; background: var(--neon-purple); color: #fff; padding: 15px 25px; border-radius: 50px; font-weight: bold; box-shadow: 0 0 20px rgba(157, 0, 255, 0.5); cursor: pointer; border: none; z-index: 50; animation: pulsando 2s infinite; }
        @keyframes pulsando { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        
        /* Banner de Cookies */
        #cookie-banner {
            display: none;
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 600px;
            background-color: #000; border: 1px solid var(--neon-green);
            padding: 20px; z-index: 200; box-shadow: 0 0 20px rgba(0, 255, 65, 0.2);
            text-align: center; border-radius: 10px;
        }
        #cookie-banner p { margin-bottom: 15px; font-size: 0.9rem; }
        .cookie-btn { padding: 10px 20px; border: none; cursor: pointer; font-weight: bold; margin: 0 5px; border-radius: 5px; }
        .btn-accept { background: var(--neon-green); color: #000; }
        .btn-deny { background: transparent; border: 1px solid #555; color: #aaa; }

        #loading { text-align: center; color: var(--neon-purple); margin-top: 50px; display: none; font-size: 1.2rem; }
    </style>
</head>
<body>

    <div id="home-view">
        <header>
            <h1>Linux_Lab_</h1>
            <div id="relogio">00:00:00</div>
            <div class="search-box">
                <input type="text" id="busca-input" placeholder="Buscar no sistema..." onkeyup="window.filtrarPosts()">
            </div>
        </header>

        <div class="container">
            <div id="loading">Sincronizando...</div>
            <div class="grid" id="grid-posts">
                </div>
        </div>
    </div>

    <button class="btn-pix" onclick="window.fazerPix()">üí∏ Apoiar</button>

    <div id="cookie-banner">
        <p>üç™ <strong>Sistema:</strong> Utilizamos cookies para salvar suas prefer√™ncias.</p>
        <button class="cookie-btn btn-accept" onclick="window.aceitarCookies()">[ACEITAR]</button>
        <button class="cookie-btn btn-deny" onclick="window.recusarCookies()">[RECUSAR]</button>
    </div>

    <div id="leitura-overlay">
        <button class="btn-voltar" onclick="window.fecharPost()">< Voltar ao Lab</button>
        <div id="conteudo-post"></div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, query, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // SUAS CHAVES REAIS
        const firebaseConfig = {
            apiKey: "AIzaSyDnkmZ7BMasKQQGnAQSTi3jxiuCbxyLU7M",
            authDomain: "meubloglinux.firebaseapp.com",
            projectId: "meubloglinux",
            storageBucket: "meubloglinux.firebasestorage.app",
            messagingSenderId: "262696388382",
            appId: "1:262696388382:web:d2784dc5dbba922cc8eb0f"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        let listaArtigos = [];

        // --- 1. COOKIES ---
        function verificarCookies() {
            const decisao = localStorage.getItem('linuxLabCookies');
            if (!decisao) { document.getElementById('cookie-banner').style.display = 'block'; }
        }
        window.aceitarCookies = function() {
            localStorage.setItem('linuxLabCookies', 'aceito');
            document.getElementById('cookie-banner').style.display = 'none';
        }
        window.recusarCookies = function() {
            localStorage.setItem('linuxLabCookies', 'recusado');
            document.getElementById('cookie-banner').style.display = 'none';
        }

        // --- 2. SINCRONIZA√á√ÉO REAL-TIME ---
        function iniciarSincronizacao() {
            const grid = document.getElementById('grid-posts');
            const loading = document.getElementById('loading');
            loading.style.display = 'block';

            const q = query(collection(db, "artigos"));
            
            onSnapshot(q, (snapshot) => {
                listaArtigos = [];
                snapshot.forEach((doc) => {
                    let dados = doc.data();
                    dados.id = doc.id; 
                    listaArtigos.push(dados);
                });
                renderizar(listaArtigos);
                loading.style.display = 'none';
            }, (error) => {
                console.error("Erro:", error);
                grid.innerHTML = '<p style="color:red; text-align:center;">Falha na conex√£o.</p>';
            });
        }

        function renderizar(lista) {
            const grid = document.getElementById('grid-posts');
            grid.innerHTML = '';
            
            if(lista.length === 0) {
                grid.innerHTML = '<p style="text-align:center;">Carregando...</p>';
                return;
            }

            const listaInvertida = [...lista].reverse();

            listaInvertida.forEach(post => {
                const cat = post.categoria || 'Geral';
                const tit = post.titulo || 'Sem T√≠tulo';
                
                grid.innerHTML += `
                    <div class="card" onclick="window.abrirPost('${post.id}')">
                        <span>// ${cat}</span>
                        <h2>${tit}</h2>
                    </div>
                `;
            });
        }

        // --- 3. NAVEGA√á√ÉO ---
        window.abrirPost = function(id) {
            const post = listaArtigos.find(p => p.id === id);
            if (post) {
                let conteudoHTML = post.conteudo || post.texto || '<p>Sem conte√∫do...</p>';
                if (!conteudoHTML.includes('<h2>')) {
                    conteudoHTML = `<h2>${post.titulo}</h2>` + conteudoHTML;
                }
                document.getElementById('conteudo-post').innerHTML = conteudoHTML;
                document.getElementById('home-view').style.display = 'none';
                document.getElementById('leitura-overlay').style.display = 'block';
                window.scrollTo(0,0);
                history.pushState({page: 'leitura'}, null, '#leitura');
            }
        };

        window.fecharPost = function() { history.back(); };

        window.filtrarPosts = function() {
            const termo = document.getElementById('busca-input').value.toLowerCase();
            const filtrados = listaArtigos.filter(post => 
                (post.titulo && post.titulo.toLowerCase().includes(termo)) || 
                (post.categoria && post.categoria.toLowerCase().includes(termo))
            );
            const grid = document.getElementById('grid-posts');
            grid.innerHTML = '';
            filtrados.reverse().forEach(post => {
                grid.innerHTML += `<div class="card" onclick="window.abrirPost('${post.id}')"><span>// ${post.categoria}</span><h2>${post.titulo}</h2></div>`;
            });
        };

        // --- 4. PIX ATUALIZADO ---
        window.fazerPix = function() {
            // SUA CHAVE NOVA AQUI:
            const minhaChavePix = "pixlinuxblog@gmail.com"; 

            navigator.clipboard.writeText(minhaChavePix).then(function() {
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                alert("‚úÖ Chave PIX copiada!\n\n" + minhaChavePix + "\n\nObrigado pelo apoio! üêß");
            }).catch(function(err) {
                prompt("Copie a chave abaixo:", minhaChavePix);
            });
        };

        // --- 5. SISTEMA ---
        function atualizarRelogio() {
            document.getElementById('relogio').innerText = new Date().toLocaleTimeString('pt-BR');
        }
        setInterval(atualizarRelogio, 1000);
        atualizarRelogio();
        
        window.addEventListener('popstate', function() {
            document.getElementById('leitura-overlay').style.display = 'none';
            document.getElementById('home-view').style.display = 'block';
        });

        // INICIALIZA√á√ÉO
        iniciarSincronizacao();
        verificarCookies();

    </script>
</body>
</html>