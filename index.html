<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linux Lab | Cyberpunk</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        /* --- ESTILO GERAL --- */
        :root { --bg: #050505; --panel: rgba(17, 17, 17, 0.95); --text: #eee; --neon-green: #00ff41; --neon-purple: #9d00ff; }
        body { background-color: var(--bg); color: var(--text); font-family: 'Courier New', monospace; margin: 0; padding-bottom: 0; overflow-x: hidden; }
        
        /* MATRIX BACKGROUND */
        canvas#matrix { position: fixed; top: 0; left: 0; z-index: -1; width: 100%; height: 100%; }

        /* CABE√áALHO */
        header { text-align: center; padding: 20px; border-bottom: 2px solid var(--neon-green); background: rgba(0,0,0,0.8); backdrop-filter: blur(5px); }
        h1 { margin: 0; color: var(--neon-green); text-transform: uppercase; letter-spacing: 2px; }
        #relogio { font-size: 2.5rem; font-weight: bold; text-shadow: 0 0 10px var(--neon-green); margin: 10px 0; }
        
        /* NOVO: BARRA DE NAVEGA√á√ÉO (MENU) */
        .nav-bar {
            margin-top: 15px;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: transparent;
            border: 1px solid var(--neon-green);
            color: var(--neon-green);
            padding: 8px 16px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            text-transform: uppercase;
            transition: 0.3s;
            text-decoration: none; /* Para links funcionarem como bot√µes */
            display: inline-block;
        }

        .nav-btn:hover {
            background: var(--neon-green);
            color: #000;
            box-shadow: 0 0 15px var(--neon-green);
        }

        /* EFEITO DE DIGITA√á√ÉO */
        .cursor-blink { animation: piscar 1s infinite; font-weight: bold; color: var(--neon-green); }
        @keyframes piscar { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }

        /* BUSCA */
        .search-box { margin: 20px auto; max-width: 90%; text-align: center; }
        #busca-input { width: 100%; max-width: 400px; padding: 10px; background: #000; border: 1px solid var(--neon-purple); color: var(--neon-green); outline: none; border-radius: 5px; }

        /* GRID */
        .container { padding: 20px; max-width: 800px; margin: 0 auto; min-height: 60vh; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        
        /* CARDS */
        .card { background: var(--panel); border: 1px solid #333; border-radius: 8px; overflow: hidden; transition: 0.3s; position: relative; display: flex; flex-direction: column; }
        .card:hover { border-color: var(--neon-green); transform: translateY(-5px); box-shadow: 0 0 15px rgba(0, 255, 65, 0.2); }
        
        /* IMAGEM DO CARD */
        .card-img { width: 100%; height: 160px; object-fit: cover; border-bottom: 1px solid #333; display: block; background: #222; }
        
        .card-body { padding: 15px; }
        .card h2 { color: #fff; font-size: 1.2rem; margin: 5px 0; }
        .card span { font-size: 0.8rem; color: var(--neon-purple); display: block; margin-bottom: 5px; }
        
        /* LIKES */
        .like-area { margin-top: 10px; display: flex; align-items: center; font-size: 0.9rem; color: #ccc; }
        .btn-like { background: none; border: 1px solid #333; color: #ccc; cursor: pointer; padding: 5px 12px; border-radius: 20px; margin-right: 5px; transition: 0.2s; display: flex; align-items: center; gap: 5px; }
        .btn-like:hover { border-color: #ff4040; color: #ff4040; }
        .btn-like.curtido { background: rgba(255, 64, 64, 0.2); border-color: #ff4040; color: #ff4040; cursor: default; }

        /* TELAS DE OVERLAY (LEITURA E SOBRE) */
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); overflow-y: auto; z-index: 100; padding: 20px; box-sizing: border-box; }
        .btn-voltar { background: transparent; border: 1px solid var(--neon-green); color: var(--neon-green); padding: 10px 20px; font-weight: bold; cursor: pointer; margin-bottom: 20px; }
        
        /* Conte√∫do dos posts e do sobre */
        .overlay-content h2 { color: var(--neon-green); border-bottom: 1px solid #333; padding-bottom: 10px; }
        .overlay-content img { max-width: 100%; border-radius: 5px; margin: 10px 0; border: 1px solid var(--neon-purple); }
        .overlay-content p { line-height: 1.6; color: #ccc; margin-bottom: 15px; }
        pre { background: #1a1a1a; padding: 10px; border-radius: 5px; overflow-x: auto; border: 1px solid #333; color: var(--neon-green); }

        /* BOT√ÉO PIX */
        .btn-pix { position: fixed; bottom: 20px; right: 20px; background: var(--neon-purple); color: #fff; padding: 15px 25px; border-radius: 50px; font-weight: bold; box-shadow: 0 0 20px rgba(157, 0, 255, 0.5); cursor: pointer; border: none; z-index: 50; animation: pulsando 2s infinite; }
        @keyframes pulsando { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        /* COOKIES */
        #cookie-banner { display: none; position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 600px; background-color: #000; border: 1px solid var(--neon-green); padding: 20px; z-index: 200; border-radius: 10px; text-align: center; }
        .cookie-btn { padding: 10px 20px; margin: 5px; cursor: pointer; font-weight: bold; border-radius: 5px; }
        .btn-accept { background: var(--neon-green); border: none; }
        .btn-deny { background: transparent; border: 1px solid #555; color: #fff; }

        /* RODAP√â */
        footer { text-align: center; padding: 40px 20px; border-top: 1px solid var(--neon-green); background: #000; margin-top: 50px; position: relative; z-index: 10; }
        .social-links { margin: 15px 0; }
        .social-links a { color: var(--neon-purple); text-decoration: none; margin: 0 15px; font-weight: bold; font-size: 1.1rem; transition: 0.3s; }
        .social-links a:hover { color: var(--neon-green); text-shadow: 0 0 15px var(--neon-green); letter-spacing: 2px; }
        .copyright { color: #444; font-size: 0.8rem; }
    </style>
</head>
<body>

    <canvas id="matrix"></canvas>

    <div id="home-view">
        <header>
            <h1>Linux_Lab_</h1>
            <div id="relogio">00:00:00</div>
            
            <div id="terminal-typing" style="color:var(--neon-purple); font-size:0.9rem; margin: 10px 0; min-height: 20px;">
                > _
            </div>

            <div class="nav-bar">
                <button class="nav-btn" onclick="window.abrirSobre()">[ üíæ SOBRE ]</button>
                <a href="mailto:danilogardiano@gmail.com?subject=Ideia para o Linux Lab&body=Ola Danilo, tenho uma sugest√£o de post:" class="nav-btn">[ üí° ENVIAR IDEIA ]</a>
            </div>

            <div class="search-box">
                <input type="text" id="busca-input" placeholder="Buscar no sistema..." onkeyup="window.filtrarPosts()">
            </div>
        </header>

        <div class="container">
            <div id="loading" style="text-align:center; color:var(--neon-purple); margin-top:20px;">Carregando sistema...</div>
            <div class="grid" id="grid-posts"></div>
        </div>

        <footer>
            <p style="color: #fff; font-weight: bold;">LINUX_LAB_ // SYSTEM.ROOT</p>
            <div class="social-links">
                <a href="https://x.com/DaniloGardiano" target="_blank">TWITTER</a>
            </div>
            <p class="copyright">Developed by <strong>Danilo</strong> ¬© 2026<br>All systems operational.</p>
        </footer>
    </div>

    <button class="btn-pix" onclick="window.fazerPix()">üí∏ Apoiar</button>

    <div id="cookie-banner">
        <p>üç™ Sistema: Aceita cookies?</p>
        <button class="cookie-btn btn-accept" onclick="window.aceitarCookies()">ACEITAR</button>
        <button class="cookie-btn btn-deny" onclick="window.recusarCookies()">RECUSAR</button>
    </div>

    <div id="leitura-overlay" class="overlay">
        <button class="btn-voltar" onclick="window.fecharOverlays()">< Voltar ao Lab</button>
        <div id="conteudo-post" class="overlay-content"></div>
    </div>

    <div id="sobre-overlay" class="overlay">
        <button class="btn-voltar" onclick="window.fecharOverlays()">< Voltar ao Lab</button>
        <div class="overlay-content" style="max-width: 800px; margin: 0 auto;">
            <h2>// SOBRE O PROJETO</h2>
            <p>O <strong>Linux Lab</strong> √© um experimento digital focado em tecnologia, hacking √©tico e cultura open source.</p>
            <p>Este sistema foi desenvolvido do zero utilizando tecnologias modernas de front-end e Firebase para armazenamento de dados em tempo real.</p>
            
            <h3>// MISS√ÉO</h3>
            <p>> Compartilhar conhecimento acess√≠vel.</p>
            <p>> Desmistificar o uso do Linux para jogos e trabalho.</p>
            <p>> Criar uma comunidade engajada e descentralizada.</p>

            <h3>// DESENVOLVEDOR</h3>
            <p>Criado e mantido por <strong>Danilo Gardiano</strong>.</p>
            <p>Status: <span style="color:var(--neon-green)">ONLINE</span></p>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, query, onSnapshot, doc, updateDoc, increment } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDnkmZ7BMasKQQGnAQSTi3jxiuCbxyLU7M",
            authDomain: "meubloglinux.firebaseapp.com",
            projectId: "meubloglinux",
            storageBucket: "meubloglinux.firebasestorage.app",
            messagingSenderId: "262696388382",
            appId: "1:262696388382:web:d2784dc5dbba922cc8eb0f"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        let listaArtigos = [];

        // --- FUN√á√ïES DE NAVEGA√á√ÉO ---
        window.abrirSobre = function() {
            document.getElementById('home-view').style.display = 'none';
            document.getElementById('sobre-overlay').style.display = 'block';
            window.scrollTo(0,0);
        };

        window.fecharOverlays = function() {
            document.getElementById('leitura-overlay').style.display = 'none';
            document.getElementById('sobre-overlay').style.display = 'none';
            document.getElementById('home-view').style.display = 'block';
        };

        // --- EFEITO DIGITA√á√ÉO ---
        const mensagens = [
            "Iniciando Kernel v5.1...",
            "Carregando m√≥dulos de seguran√ßa...",
            "Conectando ao banco de dados Firebase...",
            "Acesso Root: CONCEDIDO.",
            "Bem-vindo ao Linux Lab."
        ];

        async function digitarTerminal() {
            const elemento = document.getElementById('terminal-typing');
            
            for (let i = 0; i < mensagens.length; i++) {
                const frase = mensagens[i];
                elemento.innerText = "> "; 
                for (let letra of frase) {
                    elemento.innerText += letra;
                    await new Promise(r => setTimeout(r, 50));
                }
                await new Promise(r => setTimeout(r, 1000));
            }
            elemento.innerHTML = "> Sistema Online <span class='cursor-blink'>_</span>";
        }
        digitarTerminal();

        // --- SISTEMA DE LIKES ---
        function jaCurtiu(id) {
            const likesSalvos = JSON.parse(localStorage.getItem('meusLikes') || '[]');
            return likesSalvos.includes(id);
        }
        function salvarLike(id) {
            const likesSalvos = JSON.parse(localStorage.getItem('meusLikes') || '[]');
            likesSalvos.push(id);
            localStorage.setItem('meusLikes', JSON.stringify(likesSalvos));
        }

        window.curtirPost = async function(event, id) {
            event.stopPropagation();
            if (jaCurtiu(id)) { alert("Voc√™ j√° curtiu este post! üëç"); return; }
            
            const postRef = doc(db, "artigos", id);
            await updateDoc(postRef, { likes: increment(1) });
            salvarLike(id);
            
            confetti({ particleCount: 50, spread: 60, origin: { x: event.clientX / window.innerWidth, y: event.clientY / window.innerHeight } });
        };

        // --- MATRIX RAIN ---
        const canvas = document.getElementById('matrix');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        const letters = "010101LINUXCODEHACKERGLITCH";
        const fontSize = 14;
        const columns = canvas.width / fontSize;
        const drops = Array(Math.floor(columns)).fill(1);
        function drawMatrix() {
            ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "#0F0";
            ctx.font = fontSize + "px monospace";
            for (let i = 0; i < drops.length; i++) {
                const text = letters[Math.floor(Math.random() * letters.length)];
                ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
                drops[i]++;
            }
        }
        setInterval(drawMatrix, 50);

        // --- RENDERIZA√á√ÉO ---
        function iniciarSincronizacao() {
            const grid = document.getElementById('grid-posts');
            const loading = document.getElementById('loading');
            const q = query(collection(db, "artigos"));
            
            onSnapshot(q, (snapshot) => {
                listaArtigos = [];
                snapshot.forEach((doc) => {
                    let dados = doc.data();
                    dados.id = doc.id; 
                    listaArtigos.push(dados);
                });
                renderizar(listaArtigos);
                loading.style.display = 'none';
            });
        }

        function renderizar(lista) {
            const grid = document.getElementById('grid-posts');
            grid.innerHTML = '';
            const listaInvertida = [...lista].reverse();

            listaInvertida.forEach(post => {
                const cat = post.categoria || 'Geral';
                const tit = post.titulo || 'Sem T√≠tulo';
                const likes = post.likes || 0;
                
                let imagemHTML = "";
                if (post.imagem && post.imagem.trim() !== "") {
                    imagemHTML = `<img src="${post.imagem}" class="card-img" onerror="this.style.display='none'">`;
                }

                const userCurtiu = jaCurtiu(post.id);
                const classeBotao = userCurtiu ? "btn-like curtido" : "btn-like";
                const icone = userCurtiu ? "‚ù§Ô∏è" : "ü§ç";

                grid.innerHTML += `
                    <div class="card" onclick="window.abrirPost('${post.id}')">
                        ${imagemHTML}
                        <div class="card-body">
                            <span>// ${cat}</span>
                            <h2>${tit}</h2>
                            <div class="like-area">
                                <button class="${classeBotao}" onclick="window.curtirPost(event, '${post.id}')">${icone} ${likes}</button>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        window.abrirPost = function(id) {
            const post = listaArtigos.find(p => p.id === id);
            if (post) {
                let conteudoHTML = post.conteudo || '<p>...</p>';
                if (post.imagem && post.imagem.trim() !== "") {
                    conteudoHTML = `<img src="${post.imagem}" style="width:100%; border-radius:10px; margin-bottom:20px;">` + conteudoHTML;
                }
                if (!conteudoHTML.includes('<h2>')) conteudoHTML = `<h2>${post.titulo}</h2>` + conteudoHTML;
                
                document.getElementById('conteudo-post').innerHTML = conteudoHTML;
                document.getElementById('home-view').style.display = 'none';
                document.getElementById('leitura-overlay').style.display = 'block';
                window.scrollTo(0,0);
                history.pushState({page: 'leitura'}, null, '#leitura');
            }
        };

        // Atualizado para fechar qualquer overlay
        window.fecharPost = function() { window.fecharOverlays(); };
        
        window.filtrarPosts = function() {
            const termo = document.getElementById('busca-input').value.toLowerCase();
            const filtrados = listaArtigos.filter(p => p.titulo.toLowerCase().includes(termo));
            renderizar(filtrados);
        };
        window.fazerPix = function() {
            const chave = "pixlinuxblog@gmail.com";
            navigator.clipboard.writeText(chave).then(() => {
                confetti({particleCount:150}); alert("‚úÖ Chave PIX copiada!");
            }).catch(() => prompt("Copie:", chave));
        };
        
        if(!localStorage.getItem('linuxLabCookies')) document.getElementById('cookie-banner').style.display = 'block';
        window.aceitarCookies = () => { localStorage.setItem('linuxLabCookies','ok'); document.getElementById('cookie-banner').style.display='none'; }
        window.recusarCookies = () => { localStorage.setItem('linuxLabCookies','no'); document.getElementById('cookie-banner').style.display='none'; }
        
        setInterval(() => document.getElementById('relogio').innerText = new Date().toLocaleTimeString('pt-BR'), 1000);
        window.addEventListener('popstate', () => {
            window.fecharOverlays();
        });

        iniciarSincronizacao();
    </script>
</body>
</html>